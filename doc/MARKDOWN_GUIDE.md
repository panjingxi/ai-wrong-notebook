# Markdown + 数学公式支持功能说明

## ✅ 已实现功能

### 1. **安装的依赖包**
```json
{
  "react-markdown": "支持 Markdown 渲染",
  "remark-math": "解析数学公式",
  "remark-gfm": "支持 GitHub 风格 Markdown（表格、删除线等）",
  "rehype-katex": "渲染 LaTeX 数学公式",
  "katex": "KaTeX 核心库"
}
```

### 2. **创建的组件**
- **MarkdownRenderer** (`/src/components/markdown-renderer.tsx`)
  - 自动渲染 Markdown 内容
  - 支持数学公式（LaTeX）
  - 自定义样式（标题、列表、表格、代码块等）

### 3. **更新的 AI Prompt**
AI 现在会生成包含 Markdown 格式的内容：
- 使用 Markdown 标题、列表、粗体等格式
- 数学公式使用 LaTeX 格式：
  - 行内公式：`$x^2 + 2x + 1$`
  - 块级公式：`$$\int_{0}^{1} f(x)dx$$`

### 4. **应用范围**
- ✅ 错题详情页（题目、答案、解析）
- ✅ 练习页面（题目、答案、解析）

## 📖 Markdown 功能示例

### 数学公式

**行内公式：**
```markdown
方程 $x^2 + 2x + 1 = 0$ 的解为 $x = -1$
```

**块级公式：**
```markdown
求根公式：
$$
x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}
$$
```

### 文本格式

```markdown
## 解题思路

这是一道**二次方程**问题。

步骤：
1. 识别系数 $a$, $b$, $c$
2. 计算判别式 $\Delta = b^2 - 4ac$
3. 应用求根公式

**注意**：当 $\Delta = 0$ 时，方程有*重根*。
```

### 表格

```markdown
| 系数 | 值 |
|------|-----|
| a    | 1   |
| b    | 2   |
| c    | 1   |
```

### 代码块

```markdown
计算过程：
\`\`\`
Δ = b² - 4ac
  = 2² - 4(1)(1)
  = 4 - 4
  = 0
\`\`\`
```

## 🎨 样式效果

### 标题层级
- `# H1` - 大标题
- `## H2` - 章节标题  
- `### H3` - 小节标题

### 列表
- 无序列表：`-` 或 `*`
- 有序列表：`1.`, `2.`, ...

### 强调
- **粗体**：`**文本**`
- *斜体*：`*文本*`
- `代码`：`` `代码` ``

### 引用
```markdown
> 这是一条引用
```

## 🔧 AI 生成示例

当 AI 分析题目后，会生成类似这样的内容：

```json
{
  "questionText": "求解方程 $x^2 + 2x + 1 = 0$",
  "answerText": "$x = -1$（重根）",
  "analysis": "## 解题步骤\n\n这是一道**完全平方式**问题。\n\n### 方法一：配方法\n\n原式可以配方为：\n$$x^2 + 2x + 1 = (x+1)^2 = 0$$\n\n因此：$x + 1 = 0$，即 $x = -1$\n\n### 方法二：求根公式\n\n使用求根公式：\n$$x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n\n代入 $a=1$, $b=2$, $c=1$：\n- 判别式：$\\Delta = 4 - 4 = 0$\n- 所以：$x = \\frac{-2}{2} = -1$\n\n**结论**：方程有重根 $x = -1$"
}
```

## ⚡ 使用建议

### 对于简单题目
AI 可以使用简洁的 Markdown：
```markdown
这道题考查基本运算。

答案是 $42$。
```

### 对于复杂题目
AI 可以使用完整的 Markdown 格式：
```markdown
## 解题思路

### 第一步：分析题意
根据题目，我们需要...

### 第二步：建立方程
设未知数为 $x$，则：
$$
\begin{cases}
2x + y = 5 \\
x - y = 1
\end{cases}
$$

### 第三步：求解
使用**消元法**...
```

## 📝 注意事项

1. **数学公式格式**
   - 行内：`$公式$`
   - 块级：`$$公式$$`
   - 特殊字符需转义：`\\frac`, `\\sqrt`

2. **换行**
   - Markdown 中两个空格 + 回车 = 换行
   - 空行 = 新段落

3. **代码块**
   - 三个反引号：`` ``` ``
   - 可指定语言：`` ```python ``

## 🎯 下一步

现在上传新的错题或生成练习题时，AI 会自动使用 Markdown 格式！

已有的旧数据仍然会正常显示（作为纯文本），新数据将享受完整的格式化支持。
